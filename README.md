# igCircle Blog Server

ä¸€ä¸ªåŸºäº NestJS æ„å»ºçš„åšå®¢ç³»ç»Ÿåç«¯æœåŠ¡ï¼Œæä¾›å®Œæ•´çš„åšå®¢ç®¡ç†åŠŸèƒ½å’Œ RESTful APIã€‚

## ğŸš€ é¡¹ç›®ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ**ï¼šç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€æƒé™ç®¡ç†ã€é‚®ç®±éªŒè¯
- **æ–‡ç« ç®¡ç†**ï¼šæ–‡ç« çš„åˆ›å»ºã€ç¼–è¾‘ã€å‘å¸ƒã€å½’æ¡£ã€æ‰¹é‡æ“ä½œ
- **Markdownè‡ªåŠ¨è§£æ**ï¼šè‡ªåŠ¨è§£æMarkdownæ•°æ®ï¼Œä½¿ç”¨ gray-matter è§£æ frontmatter
- **åˆ†ç±»æ ‡ç­¾**ï¼šæ–‡ç« åˆ†ç±»å’Œæ ‡ç­¾ç®¡ç†
- **è¯„è®ºç³»ç»Ÿ**ï¼šæ”¯æŒå¤šçº§è¯„è®ºã€ç‚¹èµã€ç®¡ç†å‘˜å®¡æ ¸
- **æœç´¢åŠŸèƒ½**ï¼šå…¨æ–‡æœç´¢ã€åˆ†ç±»æœç´¢ã€æ ‡ç­¾æœç´¢
- **ç»Ÿè®¡åˆ†æ**ï¼šæ–‡ç« æµè§ˆé‡ã€ç‚¹èµæ•°ã€è¯„è®ºæ•°ç­‰ç»Ÿè®¡
- **æ–‡ä»¶ä¸Šä¼ **ï¼šæ”¯æŒmarkdownã€å›¾ç‰‡ç­‰æ–‡ä»¶ä¸Šä¼ 
- **é‚®ä»¶æœåŠ¡**ï¼šéªŒè¯ç å‘é€ã€å¯†ç é‡ç½®ç­‰

### æŠ€æœ¯ç‰¹æ€§
- **ç°ä»£åŒ–æ¶æ„**ï¼šåŸºäº NestJS æ¡†æ¶ï¼Œé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡
- **æ•°æ®åº“æ”¯æŒ**ï¼šMySQL æ•°æ®åº“ï¼ŒTypeORM ä½œä¸º ORM
- **èº«ä»½è®¤è¯**ï¼šJWT Token è®¤è¯ï¼Œæ”¯æŒå¤šè®¾å¤‡ç™»å½•ç®¡ç†
- **ç¼“å­˜ç³»ç»Ÿ**ï¼š è®¾ç½®ç¼“å­˜ï¼Œæå‡æ€§èƒ½
- **æ—¥å¿—ç³»ç»Ÿ**ï¼šç»“æ„åŒ–æ—¥å¿—è®°å½•ï¼Œæ”¯æŒæ–‡ä»¶å’Œæ§åˆ¶å°è¾“å‡º
- **API æ–‡æ¡£**ï¼šé›†æˆ Swagger è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- **æ•°æ®éªŒè¯**ï¼šä½¿ç”¨ class-validator è¿›è¡Œæ•°æ®éªŒè¯
- **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯å“åº”
- **å®‰å…¨é˜²æŠ¤**ï¼šCORS é…ç½®ã€è¯·æ±‚é¢‘ç‡é™åˆ¶ã€å¯†ç åŠ å¯†

## ğŸ›  æŠ€æœ¯æ ˆ

### åç«¯æ¡†æ¶
- **NestJS** - æ¸è¿›å¼ Node.js æ¡†æ¶
- **TypeScript** - ç±»å‹å®‰å…¨çš„ JavaScript è¶…é›†

### æ•°æ®åº“
- **MySQL 8.0** - å…³ç³»å‹æ•°æ®åº“
- **TypeORM** - TypeScript ORM æ¡†æ¶
- **nestjs-cache-manager** - ç¼“å­˜æ•°æ®åº“

### èº«ä»½è®¤è¯
- **JWT** - JSON Web Token è®¤è¯
- **bcrypt** - å¯†ç åŠ å¯†

### å·¥å…·åº“
- **class-validator** - æ•°æ®éªŒè¯
- **class-transformer** - æ•°æ®è½¬æ¢
- **Swagger** - API æ–‡æ¡£ç”Ÿæˆ
- **nodemailer** - é‚®ä»¶å‘é€
- **multer** - æ–‡ä»¶ä¸Šä¼ 
- **gray-matter** - Markdown æ–‡ä»¶è§£æ
- **reading-time** - é˜…è¯»æ—¶é—´è®¡ç®—

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ app.module.ts              # åº”ç”¨ä¸»æ¨¡å—
â”œâ”€â”€ main.ts                    # åº”ç”¨å…¥å£æ–‡ä»¶
â”œâ”€â”€ common/                    # é€šç”¨æ¨¡å—
â”‚   â”œâ”€â”€ base/                  # åŸºç¡€æœåŠ¡ç±»
â”‚   â”œâ”€â”€ cache/                 # ç¼“å­˜æœåŠ¡
â”‚   â”œâ”€â”€ config/                # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ decorators/            # è‡ªå®šä¹‰è£…é¥°å™¨
â”‚   â”œâ”€â”€ exceptions/            # å¼‚å¸¸å¤„ç†
â”‚   â”œâ”€â”€ filters/               # å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ interceptors/          # æ‹¦æˆªå™¨
â”‚   â”œâ”€â”€ logger/                # æ—¥å¿—æœåŠ¡
â”‚   â”œâ”€â”€ middleware/            # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ pipes/                 # ç®¡é“
â”‚   â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”œâ”€â”€ config/                    # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ database.config.ts     # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ jwt.config.ts          # JWT é…ç½®
â”œâ”€â”€ controllers/               # æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ admin/                 # ç®¡ç†å‘˜æ¥å£
â”‚   â”œâ”€â”€ public/                # å…¬å…±æ¥å£
â”‚   â”œâ”€â”€ user/                  # ç”¨æˆ·æ¥å£
â”‚   â””â”€â”€ *.controller.ts        # å…¶ä»–æ§åˆ¶å™¨
â”œâ”€â”€ dto/                       # æ•°æ®ä¼ è¾“å¯¹è±¡
â”œâ”€â”€ entities/                  # æ•°æ®åº“å®ä½“
â”œâ”€â”€ enums/                     # æšä¸¾å®šä¹‰
â”œâ”€â”€ guards/                    # å®ˆå«
â”œâ”€â”€ modules/                   # åŠŸèƒ½æ¨¡å—
â””â”€â”€ services/                  # ä¸šåŠ¡æœåŠ¡
    â”œâ”€â”€ article/               # æ–‡ç« ç›¸å…³æœåŠ¡
    â”œâ”€â”€ common/                # é€šç”¨æœåŠ¡
    â””â”€â”€ *.service.ts           # å…¶ä»–æœåŠ¡
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- MySQL >= 8.0
- pnpm >= 7.0.0

### å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/IgnorantCircle/igcircle-blog-server
cd igcircle-blog-server

# å®‰è£…ä¾èµ–
pnpm install
```

### ç¯å¢ƒé…ç½®

1. å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š
```bash
cp .env.development.local.example .env.development.local
```

2. ä¿®æ”¹ `.env.development.local` é…ç½®ï¼š
```env
# åº”ç”¨é…ç½®
PORT=7001
NODE_ENV=development

# æ•°æ®åº“é…ç½®
DB_HOST=
DB_PORT=3306
DB_USER=root
DB_PASS=your_password
DB_NAME=your_db_name
DB_SYNCHRONIZE=false
DB_LOGGING=true

# JWTé…ç½®
JWT_SECRET=your_jwt_secret_key
JWT_EXPIRES_IN=7d

# é‚®ä»¶æœåŠ¡é…ç½®
MAIL_HOST=your_mail_host
MAIL_PORT=465
MAIL_USER=your_email@163.com
MAIL_PASS=your_email_password
MAIL_SECURE=true

# å…¶ä»–é…ç½®...
```

### æ•°æ®åº“è®¾ç½®

#### ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰
```bash
# å¯åŠ¨ MySQL å®¹å™¨
docker-compose up -d mysql
```

#### æ‰‹åŠ¨å®‰è£…
1. å®‰è£… MySQL 8.0
2. åˆ›å»ºæ•°æ®åº“ï¼š

### è¿è¡Œåº”ç”¨

```bash
# å¼€å‘æ¨¡å¼
pnpm run start:dev

# ç”Ÿäº§æ¨¡å¼
pnpm run build
pnpm run start:prod
```

åº”ç”¨å°†åœ¨ `http://localhost:7001` å¯åŠ¨ã€‚

## ğŸ“š API æ–‡æ¡£

å¯åŠ¨åº”ç”¨åï¼Œè®¿é—® `http://localhost:7001/api-docs` æŸ¥çœ‹å®Œæ•´çš„ Swagger API æ–‡æ¡£ã€‚


## ğŸ”§ å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ ESLint å’Œ Prettier è¿›è¡Œä»£ç è§„èŒƒåŒ–ï¼š

```bash
# ä»£ç æ£€æŸ¥
pnpm run lint

# ä»£ç æ ¼å¼åŒ–
pnpm run format
```

### æµ‹è¯•

```bash
# å•å…ƒæµ‹è¯•
pnpm run test

# æµ‹è¯•è¦†ç›–ç‡
pnpm run test:cov

# E2E æµ‹è¯•
pnpm run test:e2e
```

### æ„å»ºéƒ¨ç½²

```bash
# æ„å»ºé¡¹ç›®
pnpm run build

# ç”Ÿäº§ç¯å¢ƒè¿è¡Œ
pnpm run start:prod
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **å¯†ç åŠ å¯†**ï¼šä½¿ç”¨ bcrypt è¿›è¡Œå¯†ç å“ˆå¸Œ
- **JWT è®¤è¯**ï¼šå®‰å…¨çš„ Token è®¤è¯æœºåˆ¶
- **CORS é…ç½®**ï¼šè·¨åŸŸè¯·æ±‚å®‰å…¨æ§åˆ¶
- **è¯·æ±‚éªŒè¯**ï¼šä¸¥æ ¼çš„è¾“å…¥æ•°æ®éªŒè¯
- **SQL æ³¨å…¥é˜²æŠ¤**ï¼šTypeORM å‚æ•°åŒ–æŸ¥è¯¢
- **XSS é˜²æŠ¤**ï¼šè¾“å…¥æ•°æ®æ¸…ç†å’Œè½¬ä¹‰
- **é™æµå¤„ç†**ï¼šé˜²æ­¢æš´åŠ›æ”»å‡»

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

- **æ•°æ®åº“ç´¢å¼•**ï¼šå…³é”®å­—æ®µå»ºç«‹ç´¢å¼•
- **æŸ¥è¯¢ä¼˜åŒ–**ï¼šä½¿ç”¨ QueryBuilder ä¼˜åŒ–å¤æ‚æŸ¥è¯¢
- **ç¼“å­˜ç­–ç•¥**ï¼š ç¼“å­˜çƒ­ç‚¹æ•°æ®
- **åˆ†é¡µæŸ¥è¯¢**ï¼šé¿å…å¤§é‡æ•°æ®æŸ¥è¯¢
- **æ‡’åŠ è½½**ï¼šæŒ‰éœ€åŠ è½½å…³è”æ•°æ®
- **è¿æ¥æ± **ï¼šæ•°æ®åº“è¿æ¥æ± ç®¡ç†

## ğŸš€ éƒ¨ç½²æŒ‡å—

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t igcircle-blog-server .

# è¿è¡Œå®¹å™¨
docker run -p 7001:7001 igcircle-blog-server
```

### PM2 éƒ¨ç½²

```bash
# å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨åº”ç”¨
pm2 start dist/main.js --name "blog-server"

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs blog-server
```

## é¡¹ç›®é“¾æ¥

- ç”¨æˆ·ç«¯ï¼š[igcircle-blog-web](https://github.com/IgnorantCircle/igcircle-blog-client)
- ç®¡ç†ç«¯ï¼š[igcircle-blog-mobile](https://github.com/IgnorantCircle/igcircle-blog-admin)
- æœåŠ¡ç«¯ï¼š[igcircle-blog-mobile](https://github.com/IgnorantCircle/igcircle-blog-server)

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ UNLICENSED è®¸å¯è¯ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- é¡¹ç›® Issues: [GitHub Issues]()
- é‚®ç®±: igcircle@163.com

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œå¼€æºç¤¾åŒºã€‚

---

**æ³¨æ„**ï¼šè¿™æ˜¯ä¸€ä¸ªå¼€å‘ä¸­çš„é¡¹ç›®ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½è¿˜åœ¨å®Œå–„ä¸­ã€‚æ¬¢è¿æå‡ºå»ºè®®å’Œè´¡çŒ®ä»£ç ï¼
